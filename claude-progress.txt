# Server Monitor - Agent Progress Log

## Project Status: Active Development
## Last Updated: 2026-02-15

### Completed
- Initial project setup (Express backend + Vue 3 frontend)
- Dashboard with real-time CPU/memory charts (Chart.js)
- Process list with search, sort, kill functionality
- WebSocket real-time updates with polling fallback
- Disk usage and network I/O display
- Toast notifications and confirm modal components
- GitHub repo created at cjy233/kanban
- Feature #23: Responsive layout works on mobile widths
- Feature #25: Dark mode theme toggle
- Feature #26: Auto-refresh toggle for process list
- Feature #27: CPU per-core breakdown display
- Feature #28: System info panel (OS, hostname, kernel)
- Feature #29: Export process list to CSV
- Feature #30: Chart time range selector (1min, 5min, 15min)
- Feature #31: Backend API unit tests with vitest
- Feature #32: Frontend component tests with vitest
- Feature #36: Process command-line search (not just name)
- Feature #37: Disk I/O read/write speed display
- Feature #38: Network traffic trend chart

### Current State
- All core features implemented and functional
- Backend runs on port 7777, frontend uses Vite dev server with proxy
- Responsive CSS added: mobile-first layout with 768px desktop breakpoint
- Dark mode: toggle button in nav, CSS variables for dark palette, Chart.js grid colors update, localStorage persistence
- Auto-refresh toggle on Processes page: checkbox controls 5-second polling interval, manual refresh always available
- CPU per-core breakdown: Dashboard shows individual core bars with color-coded load levels, updates via both REST and WebSocket
- System info panel: Dashboard shows OS distro, hostname, platform, and kernel version; data loaded once from /api/stats; styled with monospace font
- Export CSV: Processes page has "导出 CSV" button in toolbar; exports filtered process list as CSV with PID, Name, CPU, Memory, User columns
- Chart time range selector: Dashboard charts have 1m/5m/15m buttons above charts; selecting a range resizes the data window; default is 1 minute (20 data points at 3s interval)
- Backend tests: Refactored server.js into app.js (Express app) + server.js (entry point with WebSocket). 10 vitest tests covering /api/stats, /api/processes, DELETE /api/processes/:pid. Run with `cd backend && npm test`.
- Frontend tests: 27 vitest tests across 4 files covering Toast, ConfirmModal, Dashboard, Processes. Uses @vue/test-utils with jsdom. Chart.js and WebSocket mocked. Run with `cd frontend && npm test`.
- Memory alert: Warning banner appears on dashboard when memory > 90%. Shows current usage percentage and used/total bytes. Dismissible via X button, reappears if memory drops below 90% then exceeds again. Dark mode compatible.

- Process command-line search: Extended filteredProcesses computed in Processes.vue to also match against p.command (in addition to p.name and p.pid). Updated search placeholder to "搜索进程名称或命令...". Backend already returned command field, so no backend changes needed.

- Disk I/O read/write speed: Added si.fsStats() to backend /api/stats endpoint, returning rxSec/wxSec (bytes/sec). Dashboard shows disk I/O summary line above filesystem list with read/write speeds in human-readable format. Uses existing formatSpeed() helper. Values are null on first API call (fsStats needs two calls to compute delta), so the UI conditionally hides the I/O line until real values are available.

- Network traffic trend chart: Added Chart.js line chart to Dashboard showing total RX (download) and TX (upload) speeds over time. Purple line for RX, amber for TX. Added si.networkStats() to WebSocket broadcast so chart updates in real-time. Chart respects time range selector and dark mode theme. Spans full width below CPU/memory charts on desktop.

### Known Issues
- None currently tracked

### Next Session Notes
- Read this file and git log first
- Run init.sh to verify environment
- Pick next feature from features.json (lowest ID with passes: false) — should be #39
